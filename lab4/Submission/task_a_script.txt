# The following command was used on the ECE server to extract features and save the data as a CSV file for task A
mysql -B -h manta.uwaterloo.ca -u user_mskshah -p ece356db_mskshah -e "SELECT Master.playerID playerID, debut feature1, finalGame feature2, awardsCount feature3, B_H feature4, B_HR feature5, B_RBI feature6, P_H feature7, P_ER feature8, P_HR feature9, P_BB feature10, P_SO feature11, IF(inducted = 'Y' OR inducted = 'N', 1, 0) as class FROM (SELECT playerID, YEAR(debut) as debut, YEAR(finalGame) as finalGame FROM Master) as Master
LEFT JOIN (SELECT playerID, sum(H) as B_H, sum(HR) as B_HR, sum(RBI) as B_RBI FROM Batting GROUP BY playerID) as Batting on Master.playerID = Batting.playerID LEFT JOIN (SELECT playerID, sum(H) as P_H, sum(ER) as P_ER, sum(HR) as P_HR, sum(BB) as P_BB, sum(SO) as P_SO FROM Pitching GROUP BY playerID) as Pitching on Master.playerID = Pitching.playerID
LEFT JOIN (SELECT playerID, count(*) as awardsCount FROM AwardsPlayers GROUP BY playerID) as AwardsPlayers on Master.playerID = AwardsPlayers.playerID
LEFT JOIN (SELECT DISTINCT playerID, inducted, category FROM HallOfFame
INNER JOIN (SELECT playerID as inductedPlayerID, max(inducted) as wasInducted FROM HallOfFame GROUP BY inductedPlayerID) AS InductedHOF ON HallOfFame.playerID = InductedHOF.inductedPlayerID and HallOfFame.inducted = InductedHOF.wasInducted) as HallOfFame on Master.playerID = HallOfFame.playerID WHERE category = 'Player' OR debut != '' ORDER BY Master.playerID" | sed 's/\t/,/g' > output_task_a.csv

# The following command was used on the ECE server to extract features and save the data as a CSV file for task B
mysql -B -h manta.uwaterloo.ca -u user_mskshah -p ece356db_mskshah -e "SELECT HOF.playerID playerID, debut feature1, finalGame feature2, B_H feature3, B_HR feature4, B_RBI feature5, P_GS feature6, P_H feature7, P_BB feature8, P_SO feature9, awardsCount feature10, IF(inducted = 'Y', 1, 0) as class FROM
(SELECT DISTINCT playerID, inducted, category FROM HallOfFame WHERE category = 'Player') as HOF INNER JOIN (SELECT DISTINCT playerID as inductedPlayerID, max(inducted) as wasInducted FROM HallOfFame WHERE category = 'Player' GROUP BY inductedPlayerID) AS InductedHOF ON HOF.playerID = InductedHOF.inductedPlayerID and HOF.inducted = InductedHOF.wasInducted LEFT JOIN (SELECT playerID, YEAR(debut) as debut, YEAR(finalGame) as finalGame FROM Master) as Master on HOF.playerID = Master.playerID LEFT JOIN (SELECT playerID, sum(H) as B_H, sum(HR) as B_HR, sum(RBI) as B_RBI FROM Batting GROUP BY playerID) as Batting on HOF.playerID = Batting.playerID LEFT JOIN (SELECT playerID, sum(GS) as P_GS, sum(H) as P_H, sum(BB) as P_BB, sum(SO) as P_SO FROM Pitching GROUP BY playerID) as Pitching on HOF.playerID = Pitching.playerID LEFT JOIN (SELECT playerID, count(*) as awardsCount FROM AwardsPlayers GROUP BY playerID) as AwardsPlayers on Master.playerID = AwardsPlayers.playerID ORDER BY HOF.playerID" | sed 's/\t/,/g' > output_task_b.csv